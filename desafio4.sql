SELECT DISTINCT
jo.JOB_TITLE AS Cargo,
(
SELECT ROUND(AVG(SALARY), 2) FROM hr.employees GROUP BY JOB_ID HAVING JOB_ID = emp.JOB_ID
) AS 'Média salarial',
CASE
WHEN (
SELECT ROUND(AVG(SALARY), 2) FROM hr.employees GROUP BY JOB_ID HAVING JOB_ID = emp.JOB_ID
) BETWEEN 2000 AND 5800 THEN 'Júnior'
WHEN (
SELECT ROUND(AVG(SALARY), 2) FROM hr.employees GROUP BY JOB_ID HAVING JOB_ID = emp.JOB_ID
) BETWEEN 5801 AND 7500 THEN 'Pleno'
WHEN (
SELECT ROUND(AVG(SALARY), 2) FROM hr.employees GROUP BY JOB_ID HAVING JOB_ID = emp.JOB_ID
) BETWEEN 7501 AND 10500 THEN 'Sênior'
WHEN (
SELECT ROUND(AVG(SALARY), 2) FROM hr.employees GROUP BY JOB_ID HAVING JOB_ID = emp.JOB_ID
) > 10500 THEN 'CEO'
END AS Senioridade
FROM hr.employees AS emp
INNER JOIN hr.jobs AS jo
ON emp.JOB_ID = jo.JOB_ID
ORDER BY (
SELECT ROUND(AVG(SALARY), 2) FROM hr.employees GROUP BY JOB_ID HAVING JOB_ID = emp.JOB_ID
) ASC, Cargo;
